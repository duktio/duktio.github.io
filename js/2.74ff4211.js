(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"495c":function(t,e,a){},5872:function(t,e,a){},7469:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-splitter",{staticStyle:{height:"400px"},attrs:{value:50},scopedSlots:t._u([{key:"before",fn:function(){return[a("div",{staticClass:"q-pa-md"},[a("vue-pipeline",{ref:"pipeline",attrs:{data:t.items,showArrow:!0},on:{"update:data":function(e){t.items=e},select:t.handleSelect}})],1)]},proxy:!0},{key:"after",fn:function(){return[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"text-h4 q-mb-md"},[t._v("After")]),t._l(20,(function(e){return a("div",{key:e,staticClass:"q-my-md"},[t._v(t._s(e)+". Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quis praesentium cumque magnam odio iure quidem, quod illum numquam possimus obcaecati commodi minima assumenda consectetur culpa fuga nulla ullam. In, libero.")])}))],2)]},proxy:!0}])})},n=[],i={name:"FlowGraph",props:["pipeline"],data(){return{}},computed:{items(){if(!this.pipeline)return[];const t=[],e=this.pipeline;return this.pipeline.items.forEach((a=>{let s;s="flows"===a._type?{_key:a._key,name:"start",hint:a.summary,status:"start",next:[]}:{_key:a._key,name:a.name,hint:a.summary,status:"succeed",next:[]},a.next.forEach((t=>{for(let a=0;a<e.items.length;a++)e.items[a]._key===t&&s.next.push({index:a})})),t.push(s)})),t}},methods:{handleSelect(t){this.$emit("select",t)}}},l=i,o=a("2877"),r=a("8562"),c=a("eebe"),m=a.n(c),u=Object(o["a"])(l,s,n,!1,null,null,null);e["a"]=u.exports;m()(u,"components",{QSplitter:r["a"]})},"8a14":function(t,e,a){"use strict";var s=a("5872"),n=a.n(s);n.a},ace6:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.flow&&t.pipeline?a("q-page",{staticClass:"fit",attrs:{padding:!1}},[a("div",{staticClass:"row window-height"},[a("div",{staticClass:"col-3 q-pa-lg"},[a("side-navigation-bar",{attrs:{title:t.flow.name,subtitle:t.flow.summary,icon:"waves","menu-enabled":!0,"content-enabled":!0}},[a("template",{slot:"default"},[a("div",{staticClass:"col-grow"},[a("q-btn-group",{attrs:{spread:"",unelevated:""}},[a("q-btn",{attrs:{stack:"",icon:"add"},on:{click:t.createTask}},[t._v("Task")])],1)],1)]),a("template",{slot:"menu"},[a("q-list",[a("q-item",{staticClass:"q-my-sm",attrs:{clickable:""},on:{click:t.removeFlow}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{size:"md",name:"delete",color:"negative"}})],1),a("q-item-section",[a("q-item-label",[t._v("Remove")]),a("q-item-label",{attrs:{caption:""}},[t._v("Remove the flow along with the tasks, triggers and instance information.")])],1)],1)],1)],1)],2)],1),a("div",{staticClass:"col-9"},[a("q-toolbar",[a("q-tabs",{attrs:{"active-color":"black"},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab",{attrs:{name:"definition",label:"Definition"}}),a("q-tab",{attrs:{name:"instances",label:"Instances"}})],1)],1),a("q-tab-panels",{staticClass:"bg-grey-1",attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[a("q-tab-panel",{staticClass:"flex flex-center",attrs:{name:"definition"}},[t.pipeline?a("FlowGraph",{attrs:{pipeline:t.pipeline},on:{select:t.setCurrent}}):t._e()],1),a("q-tab-panel",{attrs:{name:"instances"}},[a("instance-list",{attrs:{instances:t.instances},on:{select:t.toInstance}})],1),a("q-tab-panel",{staticClass:"no-scroll",attrs:{name:"code"}},[a("div",{staticClass:"row q-gutter-md"},[a("q-card",{staticClass:"col-grow"},[a("q-toolbar",[a("q-toolbar-title",[t._v(t._s(t.flow.name)+" code")]),a("q-btn",{attrs:{flat:"",icon:"save"}})],1),a("div",{staticClass:"col fit"},[a("codemirror",{attrs:{value:t.pipelineRaw,options:t.cmOptions}})],1)],1),a("q-card",{staticStyle:{width:"500px"}},[a("q-card-section",[a("span",{staticClass:"text-h5"},[t._v("The flow editor")]),a("p",[t._v("Having a nice flow to look at will certainly give you that fuzzy warm feeling, but there are times when you need to make changes. The flow editor allows for just that, plain and simple.")]),a("span",{staticClass:"text-h6"},[t._v("File layout")]),a("pre",[t._v('{\n  "_key": "",\n  "name": "",\n  "summary": "",\n  "tasks": {},\n  "transitions": [],\n}')])])],1)],1)])],1)],1)]),a("task-create-dialog",{attrs:{value:t.newTask,flow:t.flow._key,triggers:t.pipeline.items},on:{cancel:function(e){t.newTask=null},created:t.taskCreated}})],1):t._e()},n=[],i=(a("e6cf"),a("ddb0"),a("ded3")),l=a.n(i),o=a("2f62"),r=a("7469"),c=a("8f94"),m=(a("a7be"),a("8c2e"),a("f9d4"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{ref:"dialog",on:{hide:t.onDialogHide}},[a("q-card",{staticClass:"q-dialog-plugin",staticStyle:{width:"50vw","max-width":"1000px"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-5 bg-black text-white q-pa-lg",staticStyle:{"min-height":"500px"}},[a("span",{staticClass:"text-h5"},[t._v("New Task")]),a("p",{staticClass:"q-mt-lg"},[t._v("\n          A task is the unit of execution within a flow. A flow is usually built out of a number of tasks, each responsible\n          for performing a part of the execution\n        ")]),a("p",{staticClass:"q-mt-lg"},[t._v("\n          When a flow is scheduled, the tasks are converted into jobs which are to be executed through the agent in your environment.\n          Therefore, you may want to configure the task with a valid container image and corresponding parameters.\n        ")])]),a("div",{staticClass:"column col-grow justify-between"},[a("div",[a("q-list",{staticClass:"q-pa-lg"},[a("q-item",[a("q-item-section",[a("q-item-label",{staticClass:"text-h6"},[t._v("Name")]),a("q-item-label",{attrs:{caption:""}},[t._v("What should be the name of your new task?")])],1)],1),a("q-item",{staticClass:"q-pt-none"},[a("q-item-section",{staticClass:"q-pt-none"},[a("q-input",{attrs:{outlined:""},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)],1),a("q-item",[a("q-item-section",[a("q-item-label",{staticClass:"text-h6"},[t._v("Summary")]),a("q-item-label",{attrs:{caption:""}},[t._v("Explain in one line what your task is meant to do.")])],1)],1),a("q-item",{staticClass:"q-pt-none"},[a("q-item-section",{staticClass:"q-pt-none"},[a("q-input",{attrs:{outlined:""},model:{value:t.summary,callback:function(e){t.summary=e},expression:"summary"}})],1)],1)],1)],1),a("div",{staticClass:"q-pa-lg"},[a("q-space"),a("q-btn",{attrs:{flat:"",label:"Cancel",color:"grey"},on:{click:t.onCancelClick}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{unelevated:"",color:"primary",label:"Create"},on:{click:t.onOKClick}})],1)])])])],1)}),u=[],d={name:"TaskCreateDialog",props:["value","flow"],data(){return{step:1,name:"",summary:""}},methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onOKClick(){const t={name:this.name,summary:this.summary,previous:this.flow._key};this.$emit("ok",t),this.step=1,this.name="",this.summary=""},onCancelClick(){this.hide()}},computed:{}},p=d,h=a("2877"),f=a("24e8"),b=a("f09f"),w=a("1c1c"),k=a("66e5"),v=a("4074"),q=a("0170"),g=a("27f9"),y=a("2c91"),_=a("9c40"),C=a("eebe"),x=a.n(C),Q=Object(h["a"])(p,m,u,!1,null,null,null),$=Q.exports;x()(Q,"components",{QDialog:f["a"],QCard:b["a"],QList:w["a"],QItem:k["a"],QItemSection:v["a"],QItemLabel:q["a"],QInput:g["a"],QSpace:y["a"],QBtn:_["a"]});var T=a("2ef0"),S=a.n(T),I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.instances&&t.instances.total>0?a("q-table",{attrs:{flat:"",data:t.instances.items,columns:t.columns,"row-key":"name","no-data-label":"I didn't find anything for you"},on:{"row-click":t.onRowSelected},scopedSlots:t._u([{key:"body-cell-actions",fn:function(t){return[a("q-td",{attrs:{"auto-width":"",props:t}})]}}],null,!1,628361987)}):t._e()},O=[],j={name:"InstanceList",components:{},props:["instances"],data(){return{columns:[{name:"name",align:"left",label:"Name",field:"_key",sortable:!0,style:"width: 300px"},{name:"status",align:"left",label:"Status",field:"flow_status",sortable:!0,style:"width: 300px"},{name:"actions",align:"right",label:"Actions",sortable:!1,style:"width: 300px"}]}},methods:{onRowSelected(t,e){this.$emit("select",e)}}},E=j,N=a("eaac"),R=a("db86"),F=Object(h["a"])(E,I,O,!1,null,null,null),B=F.exports;x()(F,"components",{QTable:N["a"],QTd:R["a"],QBtn:_["a"]});var L=a("df45"),A={name:"Flow",data(){return{tab:"definition",newTask:null,cmOptions:{theme:"base16-dark",tabSize:4,lineNumbers:!0,mode:"text/javascript"}}},components:{SideNavigationBar:L["a"],InstanceList:B,TaskCreateDialog:$,FlowGraph:r["a"],codemirror:c["codemirror"]},methods:{toInstance(t){this.$router.push(`/me/namespaces/${this.namespace._key}/flows/${this.flow._key}/instances/${t._key}`)},createTask(){const t=this;this.$q.dialog({component:$,parent:this,flow:this.flow}).onOk((e=>(t.tab="definition",t.$store.dispatch("flows/createTask",{flowKey:t.flow._key,task:e}))))},schedule(){this.$store.dispatch("flows/schedule",{ns:this.$router.currentRoute.params.ns,fk:this.flow._key})},setCurrent(t){this.$store.dispatch("flows/getTask",{ns:this.$router.currentRoute.params.ns,fk:this.flow._key,tk:t._key})},taskCreated(t){this.newTask=null,this.setCurrent(t)},removeFlow(){this.$q.dialog({title:"Confirm",message:`Are you sure you want to remove the ${this.flow.name} flow?`,cancel:!0,persistent:!0}).onOk((()=>this.$store.dispatch("flows/removeFlow",this.flow._key).then((()=>this.$router.push("/flows")))))},saveTask(){if(!this.task)return;const t=this.$refs.cmTask.content;try{const a=this;let s;try{s=JSON.parse(t)}catch(e){return}if(a.task._key!==s._key)return void a.$q.notify({type:"negative",message:"The _key field of the task may not be changed"});if(JSON.stringify(a.task,null,4)===t)return;a.$store.dispatch("flows/saveTask",{ns:a.$router.currentRoute.params.ns,fk:a.flow._key,task:s}).then((()=>{a.$q.notify({type:"positive",message:"Task saved."})}),(t=>{a.$q.notify({type:"negative",message:"Unable to save the task: "+t})}))}catch(e){this.$q.notify({type:"negative",message:e})}}},computed:l()(l()(l()(l()({},Object(o["c"])("flows",["flow","task","pipeline","instances"])),Object(o["c"])("namespaces",["namespace"])),Object(o["b"])("flows",["pipelineRaw"])),{},{taskRaw(){return this.task?JSON.stringify(this.task,null,4):""}}),created(){this.saveTask=S.a.debounce(this.saveTask,500)},preFetch({store:t,currentRoute:e}){const a="_system*namespaces:"+e.params.ns,s=`${e.params.ns}*flows/${e.params.fk}`;return Promise.all([t.dispatch("namespaces/getNamespace",a),t.dispatch("flows/getFlow",s),t.dispatch("flows/getInstances",s)]).then((e=>t.commit("navigation/set",{types:["namespaces","flows"],items:e})))}},z=A,D=(a("8a14"),a("9989")),J=a("e7a9"),G=a("0016"),P=a("65c6"),H=a("429b"),K=a("7460"),W=a("adad"),M=a("823b"),U=a("6ac5"),V=a("a370"),X=Object(h["a"])(z,s,n,!1,null,null,null);e["default"]=X.exports;x()(X,"components",{QPage:D["a"],QBtnGroup:J["a"],QBtn:_["a"],QList:w["a"],QItem:k["a"],QItemSection:v["a"],QIcon:G["a"],QItemLabel:q["a"],QToolbar:P["a"],QTabs:H["a"],QTab:K["a"],QTabPanels:W["a"],QTabPanel:M["a"],QCard:b["a"],QToolbarTitle:U["a"],QCardSection:V["a"],QSpace:y["a"]})},b6f2:function(t,e,a){"use strict";var s=a("495c"),n=a.n(s);n.a},df45:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-card",[a("q-card-section",{staticClass:"bg-primary text-white"},[a("q-item",{staticClass:"bg-primary text-white",attrs:{dark:""}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{size:"lg",name:t.icon}})],1),a("q-item-section",[a("q-item-label",{staticClass:"text-h6"},[t._v(t._s(t.title))]),a("q-item-label",{staticClass:"text-subtitle2"},[t._v(t._s(t.subtitle))])],1),t.menuEnabled?a("q-item-section",{attrs:{side:""}},[a("q-btn",{attrs:{color:"white",flat:"",icon:"more_vert"}},[a("q-menu",{attrs:{"auto-close":"","max-width":"300px"}},[t._t("menu")],2)],1)],1):t._e()],1)],1),t.contentEnabled?a("q-separator"):t._e(),t.contentEnabled?a("q-card-actions",{attrs:{align:"right"}},[t._t("default")],2):t._e()],1),t.title!==t.$auth.user.name?a("q-card",{staticClass:"q-mt-lg",attrs:{flat:"",bordered:""}},[a("q-card-section",[a("q-item",{staticClass:"text-grey-5",attrs:{dark:"",clickable:"",to:"/me"}},[a("q-item-section",{attrs:{avatar:""}},[a("q-icon",{attrs:{size:"lg",name:"face"}})],1),a("q-item-section",[a("q-item-label",{staticClass:"text-h6"},[t._v(t._s(t.$auth.user.name))]),a("q-item-label",{staticClass:"text-subtitle2"},[t._v(t._s(t.$auth.user.email))])],1)],1)],1)],1):t._e()],1)])},n=[],i=a("ded3"),l=a.n(i),o=a("2f62"),r={name:"SideNavigationBar",components:{},props:["icon","title","subtitle","contentEnabled","menuEnabled"],data(){return{}},computed:l()({},Object(o["c"])("namespaces",["namespaces"])),methods:{loadNamespaces(){return this.$store.dispatch("namespaces/getNamespaces")},logout(){this.$auth.logout({returnTo:"/"})}}},c=r,m=(a("b6f2"),a("2877")),u=a("f09f"),d=a("a370"),p=a("66e5"),h=a("4074"),f=a("0016"),b=a("0170"),w=a("9c40"),k=a("4e73"),v=a("eb85"),q=a("4b7e"),g=a("ead5"),y=a("eebe"),_=a.n(y),C=Object(m["a"])(c,s,n,!1,null,null,null);e["a"]=C.exports;_()(C,"components",{QCard:u["a"],QCardSection:d["a"],QItem:p["a"],QItemSection:h["a"],QIcon:f["a"],QItemLabel:b["a"],QBtn:w["a"],QMenu:k["a"],QSeparator:v["a"],QCardActions:q["a"],QBreadcrumbs:g["a"]})}}]);