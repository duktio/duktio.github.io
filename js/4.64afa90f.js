(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"635f":function(e,t,a){"use strict";var s=a("86a2"),n=a.n(s);n.a},7469:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-splitter",{staticStyle:{height:"400px"},attrs:{value:50},scopedSlots:e._u([{key:"before",fn:function(){return[a("div",{staticClass:"q-pa-md"},[a("vue-pipeline",{ref:"pipeline",attrs:{data:e.items,showArrow:!0},on:{"update:data":function(t){e.items=t},select:e.handleSelect}})],1)]},proxy:!0},{key:"after",fn:function(){return[a("div",{staticClass:"q-pa-md"},[a("div",{staticClass:"text-h4 q-mb-md"},[e._v("After")]),e._l(20,(function(t){return a("div",{key:t,staticClass:"q-my-md"},[e._v(e._s(t)+". Lorem ipsum dolor sit, amet consectetur adipisicing elit. Quis praesentium cumque magnam odio iure quidem, quod illum numquam possimus obcaecati commodi minima assumenda consectetur culpa fuga nulla ullam. In, libero.")])}))],2)]},proxy:!0}])})},n=[],i={name:"FlowGraph",props:["pipeline"],data(){return{}},computed:{items(){if(!this.pipeline)return[];const e=[],t=this.pipeline;return this.pipeline.items.forEach((a=>{let s;s="flows"===a._type?{_key:a._key,name:"start",hint:a.summary,status:"start",next:[]}:{_key:a._key,name:a.name,hint:a.summary,status:"succeed",next:[]},a.next.forEach((e=>{for(let a=0;a<t.items.length;a++)t.items[a]._key===e&&s.next.push({index:a})})),e.push(s)})),e}},methods:{handleSelect(e){this.$emit("select",e)}}},r=i,o=a("2877"),l=a("8562"),c=a("eebe"),m=a.n(c),p=Object(o["a"])(r,s,n,!1,null,null,null);t["a"]=p.exports;m()(p,"components",{QSplitter:l["a"]})},8151:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.flow&&e.pipeline?a("q-page",{staticClass:"fit",attrs:{padding:!1}},[a("div",{staticClass:"row window-height"},[a("div",{staticClass:"col-grow"},[a("q-toolbar",{staticClass:"bg-grey-10 text-white"},[a("q-tabs",{attrs:{"active-color":"white"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab",{attrs:{name:"dashboard",label:"Dashboard"}})],1)],1),a("q-tab-panels",{staticClass:"bg-grey-1",attrs:{animated:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("q-tab-panel",{staticClass:"flex flex-center",attrs:{name:"dashboard"}},[e.pipeline?a("FlowGraph",{attrs:{pipeline:e.pipeline},on:{select:e.setCurrent}}):e._e(),e._v("\n          "+e._s(e.instance)+"\n        ")],1)],1)],1),a("div",{staticClass:"col-3 bg-grey-10"},[a("q-toolbar",{staticClass:"text-white"},[a("q-space"),a("q-btn-group",{attrs:{flat:"",stretch:""}})],1),e.task&&"definition"===e.tab?a("q-card",{staticClass:"q-mr-xl",attrs:{flat:"",square:""}},[a("q-card-section",[a("div",{staticClass:"row items-center no-wrap"},[a("div",{staticClass:"col-grow"},[a("q-item",[a("q-item-section",[a("q-item-label",[e._v(e._s(e.task.name))]),a("q-item-label",{attrs:{caption:""}},[e._v(e._s(e.task.summary))])],1),a("q-item-section",{attrs:{side:""}},[a("q-btn",{attrs:{flat:"",color:"negative",icon:"delete"}})],1)],1)],1)])]),a("codemirror",{ref:"cmTask",attrs:{value:e.taskRaw,options:e.cmOptions},on:{input:e.saveTask}})],1):e._e()],1)])]):e._e()},n=[],i=(a("e6cf"),a("ddb0"),a("ded3")),r=a.n(i),o=a("2f62"),l=a("7469"),c=a("8f94"),m=(a("a7be"),a("8c2e"),a("f9d4"),a("2ef0")),p=a.n(m),u={name:"Instance",data(){return{tab:"dashboard",newTask:null,cmOptions:{theme:"base16-dark",tabSize:4,lineNumbers:!0,mode:"text/javascript"}}},components:{FlowGraph:l["a"],codemirror:c["codemirror"]},methods:{schedule(){this.$store.dispatch("flows/schedule",{ns:this.$router.currentRoute.params.ns,fk:this.flow._key})},setCurrent(e){this.$store.dispatch("flows/getTask",{ns:this.$router.currentRoute.params.ns,fk:this.flow._key,tk:e._key})},taskCreated(e){this.newTask=null,this.setCurrent(e)},removeFlow(){this.$q.dialog({title:"Confirm",message:`Are you sure you want to remove the ${this.flow.name} flow?`,cancel:!0,persistent:!0}).onOk((()=>this.$store.dispatch("flows/removeFlow",this.flow._key).then((()=>this.$router.push("/flows")))))},saveTask(){if(!this.task)return;const e=this.$refs.cmTask.content;try{const a=this;let s;try{s=JSON.parse(e)}catch(t){return}if(a.task._key!==s._key)return void a.$q.notify({type:"negative",message:"The _key field of the task may not be changed"});if(JSON.stringify(a.task,null,4)===e)return;a.$store.dispatch("flows/saveTask",{ns:a.$router.currentRoute.params.ns,fk:a.flow._key,task:s}).then((()=>{a.$q.notify({type:"positive",message:"Task saved."})}),(e=>{a.$q.notify({type:"negative",message:"Unable to save the task: "+e})}))}catch(t){this.$q.notify({type:"negative",message:t})}}},computed:r()(r()(r()(r()({},Object(o["c"])("flows",["flow","instance","pipeline"])),Object(o["c"])("namespaces",["namespace"])),Object(o["b"])("flows",["pipelineRaw"])),{},{taskRaw(){return this.task?JSON.stringify(this.task,null,4):""}}),created(){this.saveTask=p.a.debounce(this.saveTask,500)},preFetch({store:e,currentRoute:t}){return Promise.all([e.dispatch("namespaces/getNamespace",t.params.ns),e.dispatch("flows/getFlow",{ns:t.params.ns,fk:t.params.fk}),e.dispatch("flows/getInstance",{ns:t.params.ns,fk:t.params.fk,ik:t.params.ik})]).then((t=>e.commit("navigation/set",{types:["namespaces","flows","instances"],items:t})))}},d=u,f=(a("635f"),a("2877")),h=a("9989"),b=a("65c6"),k=a("429b"),w=a("7460"),v=a("adad"),y=a("823b"),g=a("2c91"),q=a("e7a9"),_=a("f09f"),C=a("a370"),x=a("66e5"),$=a("4074"),T=a("0170"),Q=a("9c40"),S=a("eebe"),O=a.n(S),F=Object(f["a"])(d,s,n,!1,null,null,null);t["default"]=F.exports;O()(F,"components",{QPage:h["a"],QToolbar:b["a"],QTabs:k["a"],QTab:w["a"],QTabPanels:v["a"],QTabPanel:y["a"],QSpace:g["a"],QBtnGroup:q["a"],QCard:_["a"],QCardSection:C["a"],QItem:x["a"],QItemSection:$["a"],QItemLabel:T["a"],QBtn:Q["a"]})},"86a2":function(e,t,a){}}]);